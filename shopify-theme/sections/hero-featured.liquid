{% schema %}
{
  "name": "Hero Featured Itineraries",
  "settings": [
    {
      "type": "text",
      "id": "label",
      "label": "Label",
      "default": "Our Top Itineraries"
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "Itineraries Collection",
      "info": "Select the collection containing your itineraries"
    },
    {
      "type": "color",
      "id": "placeholder_background_color",
      "label": "Placeholder Background Color",
      "default": "#f8d4ce"
    }
  ]
}
{% endschema %}

{%- liquid
  assign placeholder_bg = section.settings.placeholder_background_color | default: settings.color_pink | default: '#f8d4ce'
-%}

<section class="py-6 px-6">
  <p class="text-xs uppercase tracking-wider text-gray mb-4">
    {{ section.settings.label }}
  </p>
  
  {%- if section.settings.collection != blank and collections[section.settings.collection].products.size > 0 -%}
    <div class="flex gap-6 overflow-x-auto pb-4 snap-x snap-mandatory scroll-smooth">
      {%- for product in collections[section.settings.collection].products -%}
        <div class="flex-shrink-0 w-full md:w-1/2 lg:w-1/3 snap-start">
          <a href="{{ product.url }}" class="block group">
            <div class="grid md:grid-cols-2 gap-8 items-center">
              {%- if product.featured_image != blank -%}
                <div class="relative aspect-4-3 overflow-hidden" style="background-color: {{ placeholder_bg }};">
                  {{
                    product.featured_image
                    | image_url: width: 800
                    | image_tag: loading: 'lazy', alt: product.title, class: 'object-cover transition-transform duration-300 group-hover:scale-105'
                  }}
                </div>
              {%- else -%}
                <div class="relative aspect-4-3 overflow-hidden" style="background-color: {{ placeholder_bg }};"></div>
              {%- endif -%}
              <div class="max-w-md">
                <h2 class="text-3xl md:text-4xl lg:text-5xl mb-4 group-hover:opacity-70 transition-opacity">
                  {{ product.title | newline_to_br }}
                </h2>
                {%- if product.type != blank -%}
                  <p class="text-lg italic mb-2">{{ product.type }}</p>
                {%- endif -%}
                {%- if product.description != blank -%}
                  <p class="text-gray mb-4 line-clamp-3">
                    {{ product.description | strip_html | truncatewords: 30 }}
                  </p>
                {%- endif -%}
                <span class="read-more">Read Itinerary</span>
              </div>
            </div>
          </a>
        </div>
      {%- endfor -%}
    </div>
  {%- else -%}
    <div class="text-center py-12">
      <p class="text-gray">No itineraries found. Please select a collection in the theme editor.</p>
    </div>
  {%- endif -%}
</section>

<style>
  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  
  .scroll-smooth {
    scroll-behavior: smooth;
  }
</style>
